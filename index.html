<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist</title>
    <style>
        /* Seu estilo CSS aqui */
    </style>
</head>
<body>

    <h2>Checklist de Inventário</h2>
    <table id="checklistTable">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Quantidade</th>
                <th>Verificado</th>
                <th>Repor</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody id="checklistBody"></tbody>
    </table>

    <div class="admin-actions" style="display:none;">
        <input class="input-field" type="text" id="itemName" placeholder="Nome do Item">
        <input class="input-field" type="number" id="itemQuantity" placeholder="Quantidade">
        <button class="button" onclick="addItem()">Adicionar Item</button>
    </div>

    <!-- Firebase v8.x -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <script>
        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCONI5jggdZmpWU6XyExDUILRwb6PZ3ww8",
            authDomain: "bvbdados.firebaseapp.com",
            databaseURL: "https://bvbdados-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "bvbdados",
            storageBucket: "bvbdados.firebasestorage.app",
            messagingSenderId: "1023617367181",
            appId: "1:1023617367181:web:1278c64ceefb14e2ff76c4",
            measurementId: "G-TYSGD43C72"
        };

        // Inicializa o Firebase
        firebase.initializeApp(firebaseConfig);

        // Função para carregar itens da checklist
        function loadChecklist() {
            const checklistRef = firebase.database().ref('checklist');
            checklistRef.on('value', (snapshot) => {
                const data = snapshot.val();
                const checklistBody = document.getElementById('checklistBody');
                checklistBody.innerHTML = '';
                for (const key in data) {
                    const item = data[key];
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.name}</td>
                        <td>${item.quantity}</td>
                        <td><input type="checkbox" ${item.checked ? 'checked' : ''} onchange="updateItem('${key}', 'checked', this.checked)"></td>
                        <td><input type="checkbox" ${item.restock ? 'checked' : ''} onchange="updateItem('${key}', 'restock', this.checked)"></td>
                        <td>
                            ${isAdmin ? `<button onclick="removeItem('${key}')">Remover</button>` : ''}
                        </td>
                    `;
                    checklistBody.appendChild(row);
                }
            });
        }

        // Função para adicionar item (admin)
        function addItem() {
            const name = document.getElementById('itemName').value;
            const quantity = document.getElementById('itemQuantity').value;
            if (name && quantity) {
                const newItem = {
                    name: name,
                    quantity: quantity,
                    checked: false,
                    restock: false
                };
                const checklistRef = firebase.database().ref('checklist');
                checklistRef.push(newItem);
                document.getElementById('itemName').value = '';
                document.getElementById('itemQuantity').value = '';
            }
        }

        // Função para remover item
        function removeItem(itemKey) {
            const checklistRef = firebase.database().ref('checklist/' + itemKey);
            checklistRef.remove()
                .then(() => {
                    console.log('Item removido com sucesso');
                })
                .catch((error) => {
                    console.error('Erro ao remover o item:', error);
                });
        }

        // Função para atualizar item (verificado / precisa repor)
        function updateItem(key, field, value) {
            const checklistRef = firebase.database().ref('checklist/' + key);
            checklistRef.update({ [field]: value });
        }

        // Detectar se é admin (com base em um parâmetro simples)
        const isAdmin = window.location.search.includes('admin=true');
        if (isAdmin) {
            document.querySelector('.admin-actions').style.display = 'block';
        }

        // Carregar checklist na inicialização
        loadChecklist();
    </script>

</body>
</html>
